# You can use a Docker image from Docker Hub or your own container registry
image: zoadilack/tavro-api
   
pipelines:
  default:
    - step:
        script:
          - mkdir ~/.ssh
          - echo $TAVRO_CORE_DEPLOYMENT_KEY > ~/.ssh/id_rsa.tmp # note: assumes base64 encoded ssh key without a passphrase
          - base64 -d ~/.ssh/id_rsa.tmp > ~/.ssh/id_rsa
          - chmod 600 ~/.ssh/id_rsa
          - base64 ~/.ssh/id_rsa
          - 'echo -e "Host *\n StrictHostKeyChecking no\n UserKnownHostsFile=/dev/null" > ~/.ssh/config'
          - composer --version
          - composer install --prefer-dist
          - phpunit --version
          - phpunit