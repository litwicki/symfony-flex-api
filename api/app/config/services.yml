services:

    tavro.aws_credentials:
        class: Aws\Credentials\Credentials
        arguments: [%aws_access_key_id%, %aws_secret_access_key%]

    tavro.aws_s3:
        class: Aws\S3\S3Client
        arguments:
            -
                #key: %aws_access_key_id%
                #secret: %aws_secret_access_key%
                region: %aws_s3_region%
                version: %aws_sdk_version%
                credentials: "@tavro.aws_credentials"

    get_set_method_normalizer:
        class: Symfony\Component\Serializer\Normalizer\GetSetMethodNormalizer
        tags:
            - { name: serializer.normalizer }
    pdo:
        class: PDO
        arguments:
            # dsn:      "mysql:dbname=%database_name%"
            dsn:      "mysql:host=%database_host%;port=%database_port%;dbname=%database_name%"
            user:     %database_user%
            password: %database_password%
        calls:
            - [setAttribute, [3, 2]] # \PDO::ATTR_ERRMODE, \PDO::ERRMODE_EXCEPTION

    session.handler.pdo:
        class:     Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler
        public:    false
        arguments:
            - "mysql:host=%database_host%;port=%database_port%;dbname=%database_name%"
            - { db_table: sessions, db_id_col: session_id, db_data_col: session_data, db_time_col: session_time, db_lifetime_col: session_lifetime, db_username: %database_user%, db_password: %database_password% }

    monolog.handler.logentries:
        class: Monolog\Handler\LogEntriesHandler
        arguments:
            token: %logentries_token%

    snc_redis:
        clients:
            default:
                type: predis
                alias: default
                dsn: "redis://%redis_username%:%redis_password%@%redis_host/1"
                logging: %kernel.debug%
            cache:
                type: predis
                alias: cache
                dsn: "redis://%redis_username%:%redis_password%@%redis_host/2"
                options:
                    profile: 2.2
                    connection_timeout: 10
                    read_write_timeout: 30
            session:
                type: predis
                alias: session
                dsn: "redis://%redis_username%:%redis_password%@%redis_host/1"
            doctrine:
                metadata_cache:
                    client: cache
                    entity_manager: default          # the name of your entity_manager connection
                    document_manager: default        # the name of your document_manager connection
                result_cache:
                    client: cache
                    entity_manager: [default, read]  # you may specify multiple entity_managers
                query_cache:
                    client: cache
                    entity_manager: default
                second_level_cache:
                    client: cache
                    entity_manager: default